(function(){var t=this,e=t._,n={},i=Array.prototype,r=Object.prototype,s=Function.prototype,o=i.push,a=i.slice,u=i.concat,h=r.toString,l=r.hasOwnProperty,c=i.forEach,d=i.map,f=i.reduce,p=i.reduceRight,g=i.filter,m=i.every,v=i.some,y=i.indexOf,_=i.lastIndexOf,w=Array.isArray,b=Object.keys,x=s.bind,C=function(t){return t instanceof C?t:this instanceof C?void(this._wrapped=t):new C(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=C),exports._=C):t._=C,C.VERSION="1.6.0";var E=C.each=C.forEach=function(t,e,i){if(null==t)return t;if(c&&t.forEach===c)t.forEach(e,i);else if(t.length===+t.length){for(var r=0,s=t.length;s>r;r++)if(e.call(i,t[r],r,t)===n)return}else for(var o=C.keys(t),r=0,s=o.length;s>r;r++)if(e.call(i,t[o[r]],o[r],t)===n)return;return t};C.map=C.collect=function(t,e,n){var i=[];return null==t?i:d&&t.map===d?t.map(e,n):(E(t,function(t,r,s){i.push(e.call(n,t,r,s))}),i)};var M="Reduce of empty array with no initial value";C.reduce=C.foldl=C.inject=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),f&&t.reduce===f)return i&&(e=C.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(E(t,function(t,s,o){r?n=e.call(i,n,t,s,o):(n=t,r=!0)}),!r)throw new TypeError(M);return n},C.reduceRight=C.foldr=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return i&&(e=C.bind(e,i)),r?t.reduceRight(e,n):t.reduceRight(e);var s=t.length;if(s!==+s){var o=C.keys(t);s=o.length}if(E(t,function(a,u,h){u=o?o[--s]:--s,r?n=e.call(i,n,t[u],u,h):(n=t[u],r=!0)}),!r)throw new TypeError(M);return n},C.find=C.detect=function(t,e,n){var i;return O(t,function(t,r,s){return e.call(n,t,r,s)?(i=t,!0):void 0}),i},C.filter=C.select=function(t,e,n){var i=[];return null==t?i:g&&t.filter===g?t.filter(e,n):(E(t,function(t,r,s){e.call(n,t,r,s)&&i.push(t)}),i)},C.reject=function(t,e,n){return C.filter(t,function(t,i,r){return!e.call(n,t,i,r)},n)},C.every=C.all=function(t,e,i){e||(e=C.identity);var r=!0;return null==t?r:m&&t.every===m?t.every(e,i):(E(t,function(t,s,o){return(r=r&&e.call(i,t,s,o))?void 0:n}),!!r)};var O=C.some=C.any=function(t,e,i){e||(e=C.identity);var r=!1;return null==t?r:v&&t.some===v?t.some(e,i):(E(t,function(t,s,o){return r||(r=e.call(i,t,s,o))?n:void 0}),!!r)};C.contains=C.include=function(t,e){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(e):O(t,function(t){return t===e})},C.invoke=function(t,e){var n=a.call(arguments,2),i=C.isFunction(e);return C.map(t,function(t){return(i?e:t[e]).apply(t,n)})},C.pluck=function(t,e){return C.map(t,C.property(e))},C.where=function(t,e){return C.filter(t,C.matches(e))},C.findWhere=function(t,e){return C.find(t,C.matches(e))},C.max=function(t,e,n){if(!e&&C.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var i=-1/0,r=-1/0;return E(t,function(t,s,o){var a=e?e.call(n,t,s,o):t;a>r&&(i=t,r=a)}),i},C.min=function(t,e,n){if(!e&&C.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var i=1/0,r=1/0;return E(t,function(t,s,o){var a=e?e.call(n,t,s,o):t;r>a&&(i=t,r=a)}),i},C.shuffle=function(t){var e,n=0,i=[];return E(t,function(t){e=C.random(n++),i[n-1]=i[e],i[e]=t}),i},C.sample=function(t,e,n){return null==e||n?(t.length!==+t.length&&(t=C.values(t)),t[C.random(t.length-1)]):C.shuffle(t).slice(0,Math.max(0,e))};var R=function(t){return null==t?C.identity:C.isFunction(t)?t:C.property(t)};C.sortBy=function(t,e,n){return e=R(e),C.pluck(C.map(t,function(t,i,r){return{value:t,index:i,criteria:e.call(n,t,i,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var V=function(t){return function(e,n,i){var r={};return n=R(n),E(e,function(s,o){var a=n.call(i,s,o,e);t(r,a,s)}),r}};C.groupBy=V(function(t,e,n){C.has(t,e)?t[e].push(n):t[e]=[n]}),C.indexBy=V(function(t,e,n){t[e]=n}),C.countBy=V(function(t,e){C.has(t,e)?t[e]++:t[e]=1}),C.sortedIndex=function(t,e,n,i){n=R(n);for(var r=n.call(i,e),s=0,o=t.length;o>s;){var a=s+o>>>1;n.call(i,t[a])<r?s=a+1:o=a}return s},C.toArray=function(t){return t?C.isArray(t)?a.call(t):t.length===+t.length?C.map(t,C.identity):C.values(t):[]},C.size=function(t){return null==t?0:t.length===+t.length?t.length:C.keys(t).length},C.first=C.head=C.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:0>e?[]:a.call(t,0,e)},C.initial=function(t,e,n){return a.call(t,0,t.length-(null==e||n?1:e))},C.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},C.rest=C.tail=C.drop=function(t,e,n){return a.call(t,null==e||n?1:e)},C.compact=function(t){return C.filter(t,C.identity)};var k=function(t,e,n){return e&&C.every(t,C.isArray)?u.apply(n,t):(E(t,function(t){C.isArray(t)||C.isArguments(t)?e?o.apply(n,t):k(t,e,n):n.push(t)}),n)};C.flatten=function(t,e){return k(t,e,[])},C.without=function(t){return C.difference(t,a.call(arguments,1))},C.partition=function(t,e){var n=[],i=[];return E(t,function(t){(e(t)?n:i).push(t)}),[n,i]},C.uniq=C.unique=function(t,e,n,i){C.isFunction(e)&&(i=n,n=e,e=!1);var r=n?C.map(t,n,i):t,s=[],o=[];return E(r,function(n,i){(e?i&&o[o.length-1]===n:C.contains(o,n))||(o.push(n),s.push(t[i]))}),s},C.union=function(){return C.uniq(C.flatten(arguments,!0))},C.intersection=function(t){var e=a.call(arguments,1);return C.filter(C.uniq(t),function(t){return C.every(e,function(e){return C.contains(e,t)})})},C.difference=function(t){var e=u.apply(i,a.call(arguments,1));return C.filter(t,function(t){return!C.contains(e,t)})},C.zip=function(){for(var t=C.max(C.pluck(arguments,"length").concat(0)),e=new Array(t),n=0;t>n;n++)e[n]=C.pluck(arguments,""+n);return e},C.object=function(t,e){if(null==t)return{};for(var n={},i=0,r=t.length;r>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},C.indexOf=function(t,e,n){if(null==t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return i=C.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,r+n):n}if(y&&t.indexOf===y)return t.indexOf(e,n);for(;r>i;i++)if(t[i]===e)return i;return-1},C.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(_&&t.lastIndexOf===_)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var r=i?n:t.length;r--;)if(t[r]===e)return r;return-1},C.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=0,s=new Array(i);i>r;)s[r++]=t,t+=n;return s};var z=function(){};C.bind=function(t,e){var n,i;if(x&&t.bind===x)return x.apply(t,a.call(arguments,1));if(!C.isFunction(t))throw new TypeError;return n=a.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(a.call(arguments)));z.prototype=t.prototype;var r=new z;z.prototype=null;var s=t.apply(r,n.concat(a.call(arguments)));return Object(s)===s?s:r}},C.partial=function(t){var e=a.call(arguments,1);return function(){for(var n=0,i=e.slice(),r=0,s=i.length;s>r;r++)i[r]===C&&(i[r]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return t.apply(this,i)}},C.bindAll=function(t){var e=a.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return E(e,function(e){t[e]=C.bind(t[e],t)}),t},C.memoize=function(t,e){var n={};return e||(e=C.identity),function(){var i=e.apply(this,arguments);return C.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},C.delay=function(t,e){var n=a.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},C.defer=function(t){return C.delay.apply(C,[t,1].concat(a.call(arguments,1)))},C.throttle=function(t,e,n){var i,r,s,o=null,a=0;n||(n={});var u=function(){a=n.leading===!1?0:C.now(),o=null,s=t.apply(i,r),i=r=null};return function(){var h=C.now();a||n.leading!==!1||(a=h);var l=e-(h-a);return i=this,r=arguments,0>=l?(clearTimeout(o),o=null,a=h,s=t.apply(i,r),i=r=null):o||n.trailing===!1||(o=setTimeout(u,l)),s}},C.debounce=function(t,e,n){var i,r,s,o,a,u=function(){var h=C.now()-o;e>h?i=setTimeout(u,e-h):(i=null,n||(a=t.apply(s,r),s=r=null))};return function(){s=this,r=arguments,o=C.now();var h=n&&!i;return i||(i=setTimeout(u,e)),h&&(a=t.apply(s,r),s=r=null),a}},C.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},C.wrap=function(t,e){return C.partial(e,t)},C.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},C.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},C.keys=function(t){if(!C.isObject(t))return[];if(b)return b(t);var e=[];for(var n in t)C.has(t,n)&&e.push(n);return e},C.values=function(t){for(var e=C.keys(t),n=e.length,i=new Array(n),r=0;n>r;r++)i[r]=t[e[r]];return i},C.pairs=function(t){for(var e=C.keys(t),n=e.length,i=new Array(n),r=0;n>r;r++)i[r]=[e[r],t[e[r]]];return i},C.invert=function(t){for(var e={},n=C.keys(t),i=0,r=n.length;r>i;i++)e[t[n[i]]]=n[i];return e},C.functions=C.methods=function(t){var e=[];for(var n in t)C.isFunction(t[n])&&e.push(n);return e.sort()},C.extend=function(t){return E(a.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},C.pick=function(t){var e={},n=u.apply(i,a.call(arguments,1));return E(n,function(n){n in t&&(e[n]=t[n])}),e},C.omit=function(t){var e={},n=u.apply(i,a.call(arguments,1));for(var r in t)C.contains(n,r)||(e[r]=t[r]);return e},C.defaults=function(t){return E(a.call(arguments,1),function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])}),t},C.clone=function(t){return C.isObject(t)?C.isArray(t)?t.slice():C.extend({},t):t},C.tap=function(t,e){return e(t),t};var T=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof C&&(t=t._wrapped),e instanceof C&&(e=e._wrapped);var r=h.call(t);if(r!=h.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=n.length;s--;)if(n[s]==t)return i[s]==e;var o=t.constructor,a=e.constructor;if(o!==a&&!(C.isFunction(o)&&o instanceof o&&C.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1;n.push(t),i.push(e);var u=0,l=!0;if("[object Array]"==r){if(u=t.length,l=u==e.length)for(;u--&&(l=T(t[u],e[u],n,i)););}else{for(var c in t)if(C.has(t,c)&&(u++,!(l=C.has(e,c)&&T(t[c],e[c],n,i))))break;if(l){for(c in e)if(C.has(e,c)&&!u--)break;l=!u}}return n.pop(),i.pop(),l};C.isEqual=function(t,e){return T(t,e,[],[])},C.isEmpty=function(t){if(null==t)return!0;if(C.isArray(t)||C.isString(t))return 0===t.length;for(var e in t)if(C.has(t,e))return!1;return!0},C.isElement=function(t){return!(!t||1!==t.nodeType)},C.isArray=w||function(t){return"[object Array]"==h.call(t)},C.isObject=function(t){return t===Object(t)},E(["Arguments","Function","String","Number","Date","RegExp"],function(t){C["is"+t]=function(e){return h.call(e)=="[object "+t+"]"}}),C.isArguments(arguments)||(C.isArguments=function(t){return!(!t||!C.has(t,"callee"))}),"function"!=typeof/./&&(C.isFunction=function(t){return"function"==typeof t}),C.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},C.isNaN=function(t){return C.isNumber(t)&&t!=+t},C.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==h.call(t)},C.isNull=function(t){return null===t},C.isUndefined=function(t){return void 0===t},C.has=function(t,e){return l.call(t,e)},C.noConflict=function(){return t._=e,this},C.identity=function(t){return t},C.constant=function(t){return function(){return t}},C.property=function(t){return function(e){return e[t]}},C.matches=function(t){return function(e){if(e===t)return!0;for(var n in t)if(t[n]!==e[n])return!1;return!0}},C.times=function(t,e,n){for(var i=Array(Math.max(0,t)),r=0;t>r;r++)i[r]=e.call(n,r);return i},C.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},C.now=Date.now||function(){return(new Date).getTime()};var S={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};S.unescape=C.invert(S.escape);var A={escape:new RegExp("["+C.keys(S.escape).join("")+"]","g"),unescape:new RegExp("("+C.keys(S.unescape).join("|")+")","g")};C.each(["escape","unescape"],function(t){C[t]=function(e){return null==e?"":(""+e).replace(A[t],function(e){return S[t][e]})}}),C.result=function(t,e){if(null==t)return void 0;var n=t[e];return C.isFunction(n)?n.call(t):n},C.mixin=function(t){E(C.functions(t),function(e){var n=C[e]=t[e];C.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),F.call(this,n.apply(C,t))}})};var I=0;C.uniqueId=function(t){var e=++I+"";return t?t+e:e},C.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,$={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;C.template=function(t,e,n){var i;n=C.defaults({},n,C.templateSettings);var r=new RegExp([(n.escape||B).source,(n.interpolate||B).source,(n.evaluate||B).source].join("|")+"|$","g"),s=0,o="__p+='";t.replace(r,function(e,n,i,r,a){return o+=t.slice(s,a).replace(j,function(t){return"\\"+$[t]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(o+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),r&&(o+="';\n"+r+"\n__p+='"),s=a+e.length,e}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{i=new Function(n.variable||"obj","_",o)}catch(a){throw a.source=o,a}if(e)return i(e,C);var u=function(t){return i.call(this,t,C)};return u.source="function("+(n.variable||"obj")+"){\n"+o+"}",u},C.chain=function(t){return C(t).chain()};var F=function(t){return this._chain?C(t).chain():t};C.mixin(C),E(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];C.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],F.call(this,n)}}),E(["concat","join","slice"],function(t){var e=i[t];C.prototype[t]=function(){return F.call(this,e.apply(this._wrapped,arguments))}}),C.extend(C.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return C})}).call(this),!function(t,e){"use strict";function n(t,e){var n,i,r=t.toLowerCase();for(e=[].concat(e),n=0;n<e.length;n+=1)if(i=e[n]){if(i.test&&i.test(t))return!0;if(i.toLowerCase()===r)return!0}}var i=e.prototype.trim,r=e.prototype.trimRight,s=e.prototype.trimLeft,o=function(t){return 1*t||0},a=function(t,e){if(1>e)return"";for(var n="";e>0;)1&e&&(n+=t),e>>=1,t+=t;return n},u=[].slice,h=function(t){return null==t?"\\s":t.source?t.source:"["+p.escapeRegExp(t)+"]"},l={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},c={};for(var d in l)c[l[d]]=d;c["'"]="#39";var f=function(){function t(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}var n=a,i=function(){return i.cache.hasOwnProperty(arguments[0])||(i.cache[arguments[0]]=i.parse(arguments[0])),i.format.call(null,i.cache[arguments[0]],arguments)};return i.format=function(i,r){var s,o,a,u,h,l,c,d=1,p=i.length,g="",m=[];for(o=0;p>o;o++)if(g=t(i[o]),"string"===g)m.push(i[o]);else if("array"===g){if(u=i[o],u[2])for(s=r[d],a=0;a<u[2].length;a++){if(!s.hasOwnProperty(u[2][a]))throw new Error(f('[_.sprintf] property "%s" does not exist',u[2][a]));s=s[u[2][a]]}else s=u[1]?r[u[1]]:r[d++];if(/[^s]/.test(u[8])&&"number"!=t(s))throw new Error(f("[_.sprintf] expecting number but found %s",t(s)));switch(u[8]){case"b":s=s.toString(2);break;case"c":s=e.fromCharCode(s);break;case"d":s=parseInt(s,10);break;case"e":s=u[7]?s.toExponential(u[7]):s.toExponential();break;case"f":s=u[7]?parseFloat(s).toFixed(u[7]):parseFloat(s);break;case"o":s=s.toString(8);break;case"s":s=(s=e(s))&&u[7]?s.substring(0,u[7]):s;break;case"u":s=Math.abs(s);break;case"x":s=s.toString(16);break;case"X":s=s.toString(16).toUpperCase()}s=/[def]/.test(u[8])&&u[3]&&s>=0?"+"+s:s,l=u[4]?"0"==u[4]?"0":u[4].charAt(1):" ",c=u[6]-e(s).length,h=u[6]?n(l,c):"",m.push(u[5]?s+h:h+s)}return m.join("")},i.cache={},i.parse=function(t){for(var e=t,n=[],i=[],r=0;e;){if(null!==(n=/^[^\x25]+/.exec(e)))i.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(e)))i.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(e)))throw new Error("[_.sprintf] huh?");if(n[2]){r|=1;var s=[],o=n[2],a=[];if(null===(a=/^([a-z_][a-z_\d]*)/i.exec(o)))throw new Error("[_.sprintf] huh?");for(s.push(a[1]);""!==(o=o.substring(a[0].length));)if(null!==(a=/^\.([a-z_][a-z_\d]*)/i.exec(o)))s.push(a[1]);else{if(null===(a=/^\[(\d+)\]/.exec(o)))throw new Error("[_.sprintf] huh?");s.push(a[1])}n[2]=s}else r|=2;if(3===r)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");i.push(n)}e=e.substring(n[0].length)}return i},i}(),p={VERSION:"2.3.0",isBlank:function(t){return null==t&&(t=""),/^\s*$/.test(t)},stripTags:function(t){return null==t?"":e(t).replace(/<\/?[^>]+>/g,"")},capitalize:function(t){return t=null==t?"":e(t),t.charAt(0).toUpperCase()+t.slice(1)},chop:function(t,n){return null==t?[]:(t=e(t),n=~~n,n>0?t.match(new RegExp(".{1,"+n+"}","g")):[t])},clean:function(t){return p.strip(t).replace(/\s+/g," ")},count:function(t,n){if(null==t||null==n)return 0;t=e(t),n=e(n);for(var i=0,r=0,s=n.length;;){if(r=t.indexOf(n,r),-1===r)break;i++,r+=s}return i},chars:function(t){return null==t?[]:e(t).split("")},swapCase:function(t){return null==t?"":e(t).replace(/\S/g,function(t){return t===t.toUpperCase()?t.toLowerCase():t.toUpperCase()})},escapeHTML:function(t){return null==t?"":e(t).replace(/[&<>"']/g,function(t){return"&"+c[t]+";"})},unescapeHTML:function(t){return null==t?"":e(t).replace(/\&([^;]+);/g,function(t,n){var i;return n in l?l[n]:(i=n.match(/^#x([\da-fA-F]+)$/))?e.fromCharCode(parseInt(i[1],16)):(i=n.match(/^#(\d+)$/))?e.fromCharCode(~~i[1]):t})},escapeRegExp:function(t){return null==t?"":e(t).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(t,e,n,i){var r=p.chars(t);return r.splice(~~e,~~n,i),r.join("")},insert:function(t,e,n){return p.splice(t,e,0,n)},include:function(t,n){return""===n?!0:null==t?!1:-1!==e(t).indexOf(n)},join:function(){var t=u.call(arguments),e=t.shift();return null==e&&(e=""),t.join(e)},lines:function(t){return null==t?[]:e(t).split("\n")},reverse:function(t){return p.chars(t).reverse().join("")},startsWith:function(t,n){return""===n?!0:null==t||null==n?!1:(t=e(t),n=e(n),t.length>=n.length&&t.slice(0,n.length)===n)},endsWith:function(t,n){return""===n?!0:null==t||null==n?!1:(t=e(t),n=e(n),t.length>=n.length&&t.slice(t.length-n.length)===n)},succ:function(t){return null==t?"":(t=e(t),t.slice(0,-1)+e.fromCharCode(t.charCodeAt(t.length-1)+1))},titleize:function(t){return null==t?"":(t=e(t).toLowerCase(),t.replace(/(?:^|\s|-)\S/g,function(t){return t.toUpperCase()}))},camelize:function(t){return p.trim(t).replace(/[-_\s]+(.)?/g,function(t,e){return e?e.toUpperCase():""})},underscored:function(t){return p.trim(t).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(t){return p.trim(t).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(t){return p.titleize(e(t).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(t){return p.capitalize(p.underscored(t).replace(/_id$/,"").replace(/_/g," "))},trim:function(t,n){return null==t?"":!n&&i?i.call(t):(n=h(n),e(t).replace(new RegExp("^"+n+"+|"+n+"+$","g"),""))},ltrim:function(t,n){return null==t?"":!n&&s?s.call(t):(n=h(n),e(t).replace(new RegExp("^"+n+"+"),""))},rtrim:function(t,n){return null==t?"":!n&&r?r.call(t):(n=h(n),e(t).replace(new RegExp(n+"+$"),""))},truncate:function(t,n,i){return null==t?"":(t=e(t),i=i||"...",n=~~n,t.length>n?t.slice(0,n)+i:t)},prune:function(t,n,i){if(null==t)return"";if(t=e(t),n=~~n,i=null!=i?e(i):"...",t.length<=n)return t;var r=function(t){return t.toUpperCase()!==t.toLowerCase()?"A":" "},s=t.slice(0,n+1).replace(/.(?=\W*\w*$)/g,r);return s=s.slice(s.length-2).match(/\w\w/)?s.replace(/\s*\S+$/,""):p.rtrim(s.slice(0,s.length-1)),(s+i).length>t.length?t:t.slice(0,s.length)+i},words:function(t,e){return p.isBlank(t)?[]:p.trim(t,e).split(e||/\s+/)},pad:function(t,n,i,r){t=null==t?"":e(t),n=~~n;var s=0;switch(i?i.length>1&&(i=i.charAt(0)):i=" ",r){case"right":return s=n-t.length,t+a(i,s);case"both":return s=n-t.length,a(i,Math.ceil(s/2))+t+a(i,Math.floor(s/2));default:return s=n-t.length,a(i,s)+t}},lpad:function(t,e,n){return p.pad(t,e,n)},rpad:function(t,e,n){return p.pad(t,e,n,"right")},lrpad:function(t,e,n){return p.pad(t,e,n,"both")},sprintf:f,vsprintf:function(t,e){return e.unshift(t),f.apply(null,e)},toNumber:function(t,e){return t?(t=p.trim(t),t.match(/^-?\d+(?:\.\d+)?$/)?o(o(t).toFixed(~~e)):0/0):0},numberFormat:function(t,e,n,i){if(isNaN(t)||null==t)return"";t=t.toFixed(~~e),i="string"==typeof i?i:",";var r=t.split("."),s=r[0],o=r[1]?(n||".")+r[1]:"";return s.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+i)+o},strRight:function(t,n){if(null==t)return"";t=e(t),n=null!=n?e(n):n;var i=n?t.indexOf(n):-1;return~i?t.slice(i+n.length,t.length):t},strRightBack:function(t,n){if(null==t)return"";t=e(t),n=null!=n?e(n):n;var i=n?t.lastIndexOf(n):-1;return~i?t.slice(i+n.length,t.length):t},strLeft:function(t,n){if(null==t)return"";t=e(t),n=null!=n?e(n):n;var i=n?t.indexOf(n):-1;return~i?t.slice(0,i):t},strLeftBack:function(t,e){if(null==t)return"";t+="",e=null!=e?""+e:e;var n=t.lastIndexOf(e);return~n?t.slice(0,n):t},toSentence:function(t,e,n,i){e=e||", ",n=n||" and ";var r=t.slice(),s=r.pop();return t.length>2&&i&&(n=p.rtrim(e)+n),r.length?r.join(e)+n+s:s},toSentenceSerial:function(){var t=u.call(arguments);return t[3]=!0,p.toSentence.apply(p,t)},slugify:function(t){if(null==t)return"";var n="ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź",i="aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz",r=new RegExp(h(n),"g");return t=e(t).toLowerCase().replace(r,function(t){var e=n.indexOf(t);return i.charAt(e)||"-"}),p.dasherize(t.replace(/[^\w\s-]/g,""))},surround:function(t,e){return[e,t,e].join("")},quote:function(t,e){return p.surround(t,e||'"')},unquote:function(t,e){return e=e||'"',t[0]===e&&t[t.length-1]===e?t.slice(1,t.length-1):t},exports:function(){var t={};for(var e in this)this.hasOwnProperty(e)&&!e.match(/^(?:include|contains|reverse)$/)&&(t[e]=this[e]);return t},repeat:function(t,n,i){if(null==t)return"";if(n=~~n,null==i)return a(e(t),n);for(var r=[];n>0;r[--n]=t);return r.join(i)},naturalCmp:function(t,n){if(t==n)return 0;if(!t)return-1;if(!n)return 1;for(var i=/(\.\d+)|(\d+)|(\D+)/g,r=e(t).toLowerCase().match(i),s=e(n).toLowerCase().match(i),o=Math.min(r.length,s.length),a=0;o>a;a++){var u=r[a],h=s[a];if(u!==h){var l=parseInt(u,10);if(!isNaN(l)){var c=parseInt(h,10);if(!isNaN(c)&&l-c)return l-c}return h>u?-1:1}}return r.length===s.length?r.length-s.length:n>t?-1:1},levenshtein:function(t,n){if(null==t&&null==n)return 0;if(null==t)return e(n).length;if(null==n)return e(t).length;t=e(t),n=e(n);for(var i,r,s=[],o=0;o<=n.length;o++)for(var a=0;a<=t.length;a++)r=o&&a?t.charAt(a-1)===n.charAt(o-1)?i:Math.min(s[a],s[a-1],i)+1:o+a,i=s[a],s[a]=r;return s.pop()},toBoolean:function(t,e,i){return"number"==typeof t&&(t=""+t),"string"!=typeof t?!!t:(t=p.trim(t),n(t,e||["true","1"])?!0:n(t,i||["false","0"])?!1:void 0)}};p.strip=p.trim,p.lstrip=p.ltrim,p.rstrip=p.rtrim,p.center=p.lrpad,p.rjust=p.lpad,p.ljust=p.rpad,p.contains=p.include,p.q=p.quote,p.toBool=p.toBoolean,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(module.exports=p),exports._s=p),"function"==typeof define&&define.amd&&define("underscore.string",[],function(){return p}),t._=t._||{},t._.string=t._.str=p}(this,String),_.mixin(_.str.exports()),_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,escape:/\{\{[^\=]([\s\S]+?)\}\}/g,interpolate:/\{\{\=([\s\S]+?)\}\}/g},$.render=function(t,e,n){var i=$(t).html(),r=_.template(i,n);return $(r(e))},$.fn.render=function(t,e,n){var i=$.render(t,e,n),r=i.wrapAll("<div />").parent().html();return $(this).html(r)},function(t,e){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(n,i,r){t.Backbone=e(t,r,n,i)});else if("undefined"!=typeof exports){var n=require("underscore");e(t,exports,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,n,i){{var r=t.Backbone,s=[],o=(s.push,s.slice);s.splice}e.VERSION="1.1.2",e.$=i,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a=e.Events={on:function(t,e,n){if(!h(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,i){if(!h(this,"once",t,[e,i])||!e)return this;var r=this,s=n.once(function(){r.off(t,s),e.apply(this,arguments)});return s._callback=e,this.on(t,s,i)},off:function(t,e,i){var r,s,o,a,u,l,c,d;if(!this._events||!h(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events=void 0,this;for(a=t?[t]:n.keys(this._events),u=0,l=a.length;l>u;u++)if(t=a[u],o=this._events[t]){if(this._events[t]=r=[],e||i)for(c=0,d=o.length;d>c;c++)s=o[c],(e&&e!==s.callback&&e!==s.callback._callback||i&&i!==s.context)&&r.push(s);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!h(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&l(n,e),i&&l(i,arguments),this},stopListening:function(t,e,i){var r=this._listeningTo;if(!r)return this;var s=!e&&!i;i||"object"!=typeof e||(i=this),t&&((r={})[t._listenId]=t);for(var o in r)t=r[o],t.off(e,i,this),(s||n.isEmpty(t._events))&&delete this._listeningTo[o];return this}},u=/\s+/,h=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(u.test(n)){for(var s=n.split(u),o=0,a=s.length;a>o;o++)t[e].apply(t,[s[o]].concat(i));return!1}return!0},l=function(t,e){var n,i=-1,r=t.length,s=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,o);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,o,a);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e);return}},c={listenTo:"on",listenToOnce:"once"};n.each(c,function(t,e){a[e]=function(e,i,r){var s=this._listeningTo||(this._listeningTo={}),o=e._listenId||(e._listenId=n.uniqueId("l"));return s[o]=e,r||"object"!=typeof i||(r=this),e[t](i,r,this),this}}),a.bind=a.on,a.unbind=a.off,n.extend(e,a);var d=e.Model=function(t,e){var i=t||{};e||(e={}),this.cid=n.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(d.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var r,s,o,a,u,h,l,c;if(null==t)return this;if("object"==typeof t?(s=t,i=e):(s={})[t]=e,i||(i={}),!this._validate(s,i))return!1;o=i.unset,u=i.silent,a=[],h=this._changing,this._changing=!0,h||(this._previousAttributes=n.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(r in s)e=s[r],n.isEqual(c[r],e)||a.push(r),n.isEqual(l[r],e)?delete this.changed[r]:this.changed[r]=e,o?delete c[r]:c[r]=e;if(!u){a.length&&(this._pending=i);for(var d=0,f=a.length;f>d;d++)this.trigger("change:"+a[d],this,c[a[d]],i)}if(h)return this;if(!u)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?n.clone(this.changed):!1;var e,i=!1,r=this._changing?this._previousAttributes:this.attributes;for(var s in t)n.isEqual(r[s],e=t[s])||((i||(i={}))[s]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=t?n.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){return e.set(e.parse(n,t),t)?(i&&i(e,n,t),void e.trigger("sync",e,n,t)):!1},j(this,t),this.sync("read",this,t)},save:function(t,e,i){var r,s,o,a=this.attributes;if(null==t||"object"==typeof t?(r=t,i=e):(r={})[t]=e,i=n.extend({validate:!0},i),r&&!i.wait){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;r&&i.wait&&(this.attributes=n.extend({},a,r)),void 0===i.parse&&(i.parse=!0);var u=this,h=i.success;return i.success=function(t){u.attributes=a;var e=u.parse(t,i);return i.wait&&(e=n.extend(r||{},e)),n.isObject(e)&&!u.set(e,i)?!1:(h&&h(u,t,i),void u.trigger("sync",u,t,i))},j(this,i),s=this.isNew()?"create":i.patch?"patch":"update","patch"===s&&(i.attrs=r),o=this.sync(s,this,i),r&&i.wait&&(this.attributes=a),o},destroy:function(t){t=t?n.clone(t):{};var e=this,i=t.success,r=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(n){(t.wait||e.isNew())&&r(),i&&i(e,n,t),e.isNew()||e.trigger("sync",e,n,t)},this.isNew())return t.success(),!1;j(this,t);var s=this.sync("delete",this,t);return t.wait||r(),s},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||$();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1):!0}});var f=["keys","values","pairs","invert","pick","omit"];n.each(f,function(t){d.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.attributes),n[t].apply(n,e)}});var p=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},g={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};n.extend(p.prototype,a,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,m))},remove:function(t,e){var i=!n.isArray(t);t=i?[t]:n.clone(t),e||(e={});var r,s,o,a;for(r=0,s=t.length;s>r;r++)a=t[r]=this.get(t[r]),a&&(delete this._byId[a.id],delete this._byId[a.cid],o=this.indexOf(a),this.models.splice(o,1),this.length--,e.silent||(e.index=o,a.trigger("remove",a,this,e)),this._removeReference(a,e));return i?t[0]:t},set:function(t,e){e=n.defaults({},e,g),e.parse&&(t=this.parse(t,e));var i=!n.isArray(t);t=i?t?[t]:[]:n.clone(t);var r,s,o,a,u,h,l,c=e.at,f=this.model,p=this.comparator&&null==c&&e.sort!==!1,m=n.isString(this.comparator)?this.comparator:null,v=[],y=[],_={},w=e.add,b=e.merge,x=e.remove,C=!p&&w&&x?[]:!1;for(r=0,s=t.length;s>r;r++){if(u=t[r]||{},o=u instanceof d?a=u:u[f.prototype.idAttribute||"id"],h=this.get(o))x&&(_[h.cid]=!0),b&&(u=u===a?a.attributes:u,e.parse&&(u=h.parse(u,e)),h.set(u,e),p&&!l&&h.hasChanged(m)&&(l=!0)),t[r]=h;
else if(w){if(a=t[r]=this._prepareModel(u,e),!a)continue;v.push(a),this._addReference(a,e)}a=h||a,!C||!a.isNew()&&_[a.id]||C.push(a),_[a.id]=!0}if(x){for(r=0,s=this.length;s>r;++r)_[(a=this.models[r]).cid]||y.push(a);y.length&&this.remove(y,e)}if(v.length||C&&C.length)if(p&&(l=!0),this.length+=v.length,null!=c)for(r=0,s=v.length;s>r;r++)this.models.splice(c+r,0,v[r]);else{C&&(this.models.length=0);var E=C||v;for(r=0,s=E.length;s>r;r++)this.models.push(E[r])}if(l&&this.sort({silent:!0}),!e.silent){for(r=0,s=v.length;s>r;r++)(a=v[r]).trigger("add",a,this,e);(l||C&&C.length)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,r=this.models.length;r>i;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return o.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return n.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return n.invoke(this.models,"get",t)},fetch:function(t){t=t?n.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var r=t.reset?"reset":"set";i[r](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},j(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?n.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,r=e.success;return e.success=function(t,n){e.wait&&i.add(t,e),r&&r(t,n,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof d)return t;e=e?n.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_addReference:function(t){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(v,function(t){p.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.models),n[t].apply(n,e)}});var y=["groupBy","countBy","sortBy","indexBy"];n.each(y,function(t){p.prototype[t]=function(e,i){var r=n.isFunction(e)?e:function(t){return t.get(e)};return n[t](this.models,r,i)}});var _=e.View=function(t){this.cid=n.uniqueId("view"),t||(t={}),n.extend(this,n.pick(t,b)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,b=["model","collection","el","id","attributes","className","tagName","events"];n.extend(_.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=n.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(n.isFunction(i)||(i=this[t[e]]),i){var r=e.match(w),s=r[1],o=r[2];i=n.bind(i,this),s+=".delegateEvents"+this.cid,""===o?this.$el.on(s,i):this.$el.on(s,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t["class"]=n.result(this,"className"));var i=e.$("<"+n.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,r){var s=C[t];n.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:s,dataType:"json"};if(r.url||(o.url=n.result(i,"url")||$()),null!=r.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),r.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",r.emulateJSON&&(o.data._method=s);var a=r.beforeSend;r.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",s),a?a.apply(this,arguments):void 0}}"GET"===o.type||r.emulateJSON||(o.processData=!1),"PATCH"===o.type&&x&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var u=r.xhr=e.ajax(n.extend(o,r));return i.trigger("request",i,u,r),u};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var E=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},M=/\((.*?)\)/g,O=/(\(\?)?:\w+/g,R=/\*\w+/g,V=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(E.prototype,a,{initialize:function(){},route:function(t,i,r){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var s=this;return e.history.route(t,function(n){var o=s._extractParameters(t,n);s.execute(r,o),s.trigger.apply(s,["route:"+i].concat(o)),s.trigger("route",i,o),e.history.trigger("route",s,i,o)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(V,"\\$&").replace(M,"(?:$1)?").replace(O,function(t,e){return e?t:"([^/?]+)"}).replace(R,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}});var k=e.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},z=/^[#\/]|\s+$/g,T=/^\/+|\/+$/g,S=/msie [\w.]+/,A=/\/$/,I=/#.*$/;k.started=!1,n.extend(k.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(A,"");t.indexOf(n)||(t=t.slice(n.length))}else t=this.getHash();return t.replace(z,"")},start:function(t){if(k.started)throw new Error("Backbone.history has already been started");k.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),r=document.documentMode,s=S.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);if(this.root=("/"+this.root+"/").replace(T,"/"),s&&this._wantsHashChange){var o=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(z,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),k.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),n.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!k.started)return!1;e&&e!==!0||(e={trigger:!!e});var n=this.root+(t=this.getFragment(t||""));if(t=t.replace(I,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new k;var B=function(t,e){var i,r=this;i=t&&n.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,e);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,t&&n.extend(i.prototype,t),i.__super__=r.prototype,i};d.extend=p.extend=E.extend=_.extend=k.extend=B;var $=function(){throw new Error('A "url" property or function must be specified')},j=function(t,e){var n=e.error;e.error=function(i){n&&n(t,i,e),t.trigger("error",t,i,e)}};return e}),function(t,e,n){"use strict";"object"==typeof exports?module.exports=e(require("underscore"),require("backbone")):"function"==typeof define&&define.amd?define(["underscore","backbone"],function(i,r){return i=i===n?t._:i,r=r===n?t.Backbone:r,t.returnExportsGlobal=e(i,r,t)}):t.returnExportsGlobal=e(t._,t.Backbone)}(this,function(t,e,n,i){"use strict";e=e===i?n.Backbone:e,t=t===i?n._:t;var r=function(){},s=e.Model.prototype.get,o=e.Model.prototype.set,a=e.Model.prototype.toJSON;return r.prototype.mutators={},r.prototype.get=function(e){var n=this.mutators!==i;return n===!0&&t.isFunction(this.mutators[e])===!0?this.mutators[e].call(this):n===!0&&t.isObject(this.mutators[e])===!0&&t.isFunction(this.mutators[e].get)===!0?this.mutators[e].get.call(this):s.call(this,e)},r.prototype.set=function(e,n,r){var s=this.mutators!==i,a=null,u=null;return a=o.call(this,e,n,r),t.isObject(e)||null===e?(u=e,r=n):(u={},u[e]=n),s===!0&&t.isObject(this.mutators[e])===!0&&(t.isFunction(this.mutators[e].set)===!0?a=this.mutators[e].set.call(this,e,u[e],r,t.bind(o,this)):t.isFunction(this.mutators[e])&&(a=this.mutators[e].call(this,e,u[e],r,t.bind(o,this)))),s===!0&&t.isObject(u)&&t.each(u,t.bind(function(e,n){if(t.isObject(this.mutators[n])===!0){var s=this.mutators[n];t.isFunction(s.set)&&(s=s.set),t.isFunction(s)&&((r===i||t.isObject(r)===!0&&r.silent!==!0&&r.mutators!==i&&r.mutators.silent!==!0)&&this.trigger("mutators:set:"+n),s.call(this,n,e,r,t.bind(o,this)))}},this)),a},r.prototype.toJSON=function(e){var n,i,r=a.call(this);return t.each(this.mutators,t.bind(function(s,o){t.isObject(this.mutators[o])===!0&&t.isFunction(this.mutators[o].get)?(n=t.has(e||{},"emulateHTTP"),i=this.mutators[o].transient,n&&i||(r[o]=t.bind(this.mutators[o].get,this)())):t.isFunction(this.mutators[o])&&(r[o]=t.bind(this.mutators[o],this)())},this)),r},r.prototype.escape=function(e){var n=this.get(e);return t.escape(null==n?"":""+n)},t.extend(e.Model.prototype,r.prototype),e.Mutators=r,r}),function(t,e){"function"==typeof define&&define.amd?define(["underscore","backbone"],e):t.amdWeb=e(t._,t.Backbone)}(this,function(t,e){var n=window.btoa,i=function(t){return n(unescape(encodeURIComponent([t.username,t.password].join(":"))))};e.BasicAuth={getHeader:function(t){return{Authorization:"Basic "+i(t)}}};var r=e.sync;e.sync=function(n,i,s){s=s||{};var o,a,u=App.getParameter("credentials");return i.credentials&&(u=t.result(i,"credentials")),null==u&&(o=s.url||t.result(i,"url"),a=o.match(/\/\/(.*):(.*)@/),a&&3===a.length&&(u={username:a[1],password:a[2]})),null!=u&&(s.headers=s.headers||{},t.extend(s.headers,e.BasicAuth.getHeader(u))),r.call(i,n,i,s)}}),function(t,e){if("function"==typeof define&&define.amd)define(["backbone","underscore"],function(n,i){return t.Marionette=e(t,n,i)});else if("undefined"!=typeof exports){var n=require("backbone"),i=require("underscore");module.exports=e(t,n,i)}else t.Marionette=e(t,t.Backbone,t._)}(this,function(t,e,n){"use strict";!function(t,e){var n=t.ChildViewContainer;return t.ChildViewContainer=function(t,e){var n=function(t){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),e.each(t,this.add,this)};e.extend(n.prototype,{add:function(t,e){var n=t.cid;return this._views[n]=t,t.model&&(this._indexByModel[t.model.cid]=n),e&&(this._indexByCustom[e]=n),this._updateLength(),this},findByModel:function(t){return this.findByModelCid(t.cid)},findByModelCid:function(t){var e=this._indexByModel[t];return this.findByCid(e)},findByCustom:function(t){var e=this._indexByCustom[t];return this.findByCid(e)},findByIndex:function(t){return e.values(this._views)[t]},findByCid:function(t){return this._views[t]},remove:function(t){var n=t.cid;return t.model&&delete this._indexByModel[t.model.cid],e.any(this._indexByCustom,function(t,e){return t===n?(delete this._indexByCustom[e],!0):void 0},this),delete this._views[n],this._updateLength(),this},call:function(t){this.apply(t,e.tail(arguments))},apply:function(t,n){e.each(this._views,function(i){e.isFunction(i[t])&&i[t].apply(i,n||[])})},_updateLength:function(){this.length=e.size(this._views)}});var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return e.each(i,function(t){n.prototype[t]=function(){var n=e.values(this._views),i=[n].concat(e.toArray(arguments));return e[t].apply(e,i)}}),n}(t,e),t.ChildViewContainer.VERSION="0.1.4",t.ChildViewContainer.noConflict=function(){return t.ChildViewContainer=n,this},t.ChildViewContainer}(e,n),function(t,e){var n=t.Wreqr,i=t.Wreqr={};return t.Wreqr.VERSION="1.3.1",t.Wreqr.noConflict=function(){return t.Wreqr=n,this},i.Handlers=function(t,e){var n=function(t){this.options=t,this._wreqrHandlers={},e.isFunction(this.initialize)&&this.initialize(t)};return n.extend=t.Model.extend,e.extend(n.prototype,t.Events,{setHandlers:function(t){e.each(t,function(t,n){var i=null;e.isObject(t)&&!e.isFunction(t)&&(i=t.context,t=t.callback),this.setHandler(n,t,i)},this)},setHandler:function(t,e,n){var i={callback:e,context:n};this._wreqrHandlers[t]=i,this.trigger("handler:add",t,e,n)},hasHandler:function(t){return!!this._wreqrHandlers[t]},getHandler:function(t){var e=this._wreqrHandlers[t];if(e)return function(){var t=Array.prototype.slice.apply(arguments);return e.callback.apply(e.context,t)}},removeHandler:function(t){delete this._wreqrHandlers[t]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(t,e),i.CommandStorage=function(){var n=function(t){this.options=t,this._commands={},e.isFunction(this.initialize)&&this.initialize(t)};return e.extend(n.prototype,t.Events,{getCommands:function(t){var e=this._commands[t];return e||(e={command:t,instances:[]},this._commands[t]=e),e},addCommand:function(t,e){var n=this.getCommands(t);n.instances.push(e)},clearCommands:function(t){var e=this.getCommands(t);e.instances=[]}}),n}(),i.Commands=function(t){return t.Handlers.extend({storageType:t.CommandStorage,constructor:function(e){this.options=e||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var n=Array.prototype.slice.call(arguments);t.Handlers.prototype.constructor.apply(this,n)},execute:function(t,e){t=arguments[0],e=Array.prototype.slice.call(arguments,1),this.hasHandler(t)?this.getHandler(t).apply(this,e):this.storage.addCommand(t,e)},_executeCommands:function(t,n,i){var r=this.storage.getCommands(t);e.each(r.instances,function(t){n.apply(i,t)}),this.storage.clearCommands(t)},_initializeStorage:function(t){var n,i=t.storageType||this.storageType;n=e.isFunction(i)?new i:i,this.storage=n}})}(i),i.RequestResponse=function(t){return t.Handlers.extend({request:function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return this.hasHandler(t)?this.getHandler(t).apply(this,e):void 0}})}(i),i.EventAggregator=function(t,e){var n=function(){};return n.extend=t.Model.extend,e.extend(n.prototype,t.Events),n}(t,e),i.Channel=function(){var n=function(e){this.vent=new t.Wreqr.EventAggregator,this.reqres=new t.Wreqr.RequestResponse,this.commands=new t.Wreqr.Commands,this.channelName=e};return e.extend(n.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(t,e){return this._connect("vent",t,e),this},connectCommands:function(t,e){return this._connect("commands",t,e),this},connectRequests:function(t,e){return this._connect("reqres",t,e),this},_connect:function(t,n,i){if(n){i=i||this;var r="vent"===t?"on":"setHandler";e.each(n,function(n,s){this[t][r](s,e.bind(n,i))},this)}}}),n}(i),i.radio=function(t){var n=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};e.extend(n.prototype,{channel:function(t){if(!t)throw new Error("Channel must receive a name");return this._getChannel(t)},_getChannel:function(e){var n=this._channels[e];return n||(n=new t.Channel(e),this._channels[e]=n),n},_proxyMethods:function(){e.each(["vent","commands","reqres"],function(t){e.each(i[t],function(e){this[t][e]=r(this,t,e)},this)},this)}});var i={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},r=function(t,e,n){return function(i){var r=t._getChannel(i)[e],s=Array.prototype.slice.call(arguments,1);return r[n].apply(r,s)}};return new n}(i),t.Wreqr}(e,n);var i=t.Marionette,r=e.Marionette={};r.VERSION="2.2.0",r.noConflict=function(){return t.Marionette=i,this},e.Marionette=r,r.Deferred=e.$.Deferred;var s=Array.prototype.slice;r.extend=e.Model.extend,r.getOption=function(t,e){if(t&&e){var n;return n=t.options&&void 0!==t.options[e]?t.options[e]:t[e]}},r.proxyGetOption=function(t){return r.getOption(this,t)},r.normalizeMethods=function(t){var e={};return n.each(t,function(t,i){n.isFunction(t)||(t=this[t]),t&&(e[i]=t)},this),e},r.normalizeUIString=function(t,e){return t.replace(/@ui\.[a-zA-Z_$0-9]*/g,function(t){return e[t.slice(4)]})},r.normalizeUIKeys=function(t,e){return"undefined"!=typeof t?(t=n.clone(t),n.each(n.keys(t),function(n){var i=r.normalizeUIString(n,e);i!==n&&(t[i]=t[n],delete t[n])}),t):void 0},r.normalizeUIValues=function(t,e){return"undefined"!=typeof t?(n.each(t,function(i,s){n.isString(i)&&(t[s]=r.normalizeUIString(i,e))}),t):void 0},r.actAsCollection=function(t,e){var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];n.each(i,function(i){t[i]=function(){var t=n.values(n.result(this,e)),r=[t].concat(n.toArray(arguments));return n[i].apply(n,r)}})},r.triggerMethod=function(t){function e(t,e,n){return n.toUpperCase()}var i,r=/(^|:)(\w)/gi,s="on"+t.replace(r,e),o=this[s];return n.isFunction(o)&&(i=o.apply(this,n.tail(arguments))),n.isFunction(this.trigger)&&this.trigger.apply(this,arguments),i},r.triggerMethodOn=function(t,e){var i,s=n.tail(arguments,2);return i=n.isFunction(t.triggerMethod)?t.triggerMethod:r.triggerMethod,i.apply(t,[e].concat(s))},r.MonitorDOMRefresh=function(t){function i(t){t._isShown=!0,s(t)}function r(t){t._isRendered=!0,s(t)}function s(t){t._isShown&&t._isRendered&&o(t)&&n.isFunction(t.triggerMethod)&&t.triggerMethod("dom:refresh")}function o(n){return e.$.contains(t,n.el)}return function(t){t.listenTo(t,"show",function(){i(t)}),t.listenTo(t,"render",function(){r(t)})}}(document.documentElement),function(t){function e(e,i,r,s){var o=s.split(/\s+/);n.each(o,function(n){var s=e[n];if(!s)throw new t.Error('Method "'+n+'" was configured as an event handler, but does not exist.');e.listenTo(i,r,s)})}function i(t,e,n,i){t.listenTo(e,n,i)}function r(t,e,i,r){var s=r.split(/\s+/);n.each(s,function(n){var r=t[n];t.stopListening(e,i,r)})}function s(t,e,n,i){t.stopListening(e,n,i)}function o(e,i,r,s,o){if(i&&r){if(!n.isFunction(r)&&!n.isObject(r))throw new t.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});n.isFunction(r)&&(r=r.call(e)),n.each(r,function(t,r){n.isFunction(t)?s(e,i,r,t):o(e,i,r,t)})}}t.bindEntityEvents=function(t,n,r){o(t,n,r,i,e)},t.unbindEntityEvents=function(t,e,n){o(t,e,n,s,r)},t.proxyBindEntityEvents=function(e,n){return t.bindEntityEvents(this,e,n)},t.proxyUnbindEntityEvents=function(e,n){return t.unbindEntityEvents(this,e,n)}}(r);var o=["description","fileName","lineNumber","name","message","number"];return r.Error=r.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/"+r.VERSION+"/",constructor:function(t,e){n.isObject(t)?(e=t,t=e.message):e||(e={});var i=Error.call(this,t);n.extend(this,n.pick(i,o),n.pick(e,o)),this.captureStackTrace(),e.url&&(this.url=this.urlRoot+e.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,r.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),r.Error.extend=r.extend,r.Callbacks=function(){this._deferred=r.Deferred(),this._callbacks=[]},n.extend(r.Callbacks.prototype,{add:function(t,e){var i=n.result(this._deferred,"promise");this._callbacks.push({cb:t,ctx:e}),i.then(function(n){e&&(n.context=e),t.call(n.context,n.options)})},run:function(t,e){this._deferred.resolve({options:t,context:e})},reset:function(){var t=this._callbacks;this._deferred=r.Deferred(),this._callbacks=[],n.each(t,function(t){this.add(t.cb,t.ctx)},this)}}),r.Controller=function(t){this.options=t||{},n.isFunction(this.initialize)&&this.initialize(this.options)},r.Controller.extend=r.extend,n.extend(r.Controller.prototype,e.Events,{destroy:function(){var t=s.call(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(t)),this.triggerMethod.apply(this,["destroy"].concat(t)),this.stopListening(),this.off(),this},triggerMethod:r.triggerMethod,getOption:r.proxyGetOption}),r.Object=function(t){this.options=n.extend({},n.result(this,"options"),t),this.initialize.apply(this,arguments)},r.Object.extend=r.extend,n.extend(r.Object.prototype,{initialize:function(){},destroy:function(){this.triggerMethod("before:destroy"),this.triggerMethod("destroy"),this.stopListening()},triggerMethod:r.triggerMethod,getOption:r.proxyGetOption,bindEntityEvents:r.proxyBindEntityEvents,unbindEntityEvents:r.proxyUnbindEntityEvents}),n.extend(r.Object.prototype,e.Events),r.Region=function(t){if(this.options=t||{},this.el=this.getOption("el"),this.el=this.el instanceof e.$?this.el[0]:this.el,!this.el)throw new r.Error({name:"NoElError",message:'An "el" must be specified for a region.'});if(this.$el=this.getEl(this.el),this.initialize){var n=s.apply(arguments);this.initialize.apply(this,n)}},n.extend(r.Region,{buildRegion:function(t,e){if(n.isString(t))return this._buildRegionFromSelector(t,e);if(t.selector||t.el||t.regionClass)return this._buildRegionFromObject(t,e);if(n.isFunction(t))return this._buildRegionFromRegionClass(t);throw new r.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(t,e){return new e({el:t})},_buildRegionFromObject:function(t,i){var r=t.regionClass||i,s=n.omit(t,"selector","regionClass");t.selector&&!s.el&&(s.el=t.selector);var o=new r(s);return t.parentEl&&(o.getEl=function(i){if(n.isObject(i))return e.$(i);var r=t.parentEl;return n.isFunction(r)&&(r=r()),r.find(i)}),o},_buildRegionFromRegionClass:function(t){return new t}}),n.extend(r.Region.prototype,e.Events,{show:function(t,e){this._ensureElement();var i=e||{},s=t!==this.currentView,o=!!i.preventDestroy,a=!!i.forceShow,u=!!this.currentView,h=!o&&s,l=s||a;return u&&this.triggerMethod("before:swapOut",this.currentView),h&&this.empty(),l?(t.once("destroy",n.bind(this.empty,this)),t.render(),u&&this.triggerMethod("before:swap",t),this.triggerMethod("before:show",t),r.triggerMethodOn(t,"before:show"),u&&this.triggerMethod("swapOut",this.currentView),this.attachHtml(t),this.currentView=t,u&&this.triggerMethod("swap",t),this.triggerMethod("show",t),r.triggerMethodOn(t,"show"),this):this},_ensureElement:function(){if(n.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length)throw new r.Error('An "el" '+this.$el.selector+" must exist in DOM")},getEl:function(t){return e.$(t)},attachHtml:function(t){this.el.innerHTML="",this.el.appendChild(t.el)},empty:function(){var t=this.currentView;if(t)return this.triggerMethod("before:empty",t),this._destroyView(),this.triggerMethod("empty",t),delete this.currentView,this},_destroyView:function(){var t=this.currentView;t.destroy&&!t.isDestroyed?t.destroy():t.remove&&t.remove()},attachView:function(t){return this.currentView=t,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this},getOption:r.proxyGetOption,triggerMethod:r.triggerMethod}),r.Region.extend=r.extend,r.RegionManager=function(t){var e=t.Controller.extend({constructor:function(e){this._regions={},t.Controller.call(this,e)},addRegions:function(t,e){n.isFunction(t)&&(t=t.apply(this,arguments));var i={};return n.each(t,function(t,r){n.isString(t)&&(t={selector:t}),t.selector&&(t=n.defaults({},t,e));var s=this.addRegion(r,t);i[r]=s},this),i},addRegion:function(e,n){var i;return i=n instanceof t.Region?n:t.Region.buildRegion(n,t.Region),this.triggerMethod("before:add:region",e,i),this._store(e,i),this.triggerMethod("add:region",e,i),i},get:function(t){return this._regions[t]},getRegions:function(){return n.clone(this._regions)},removeRegion:function(t){var e=this._regions[t];return this._remove(t,e),e},removeRegions:function(){var t=this.getRegions();return n.each(this._regions,function(t,e){this._remove(e,t)},this),t},emptyRegions:function(){var t=this.getRegions();return n.each(t,function(t){t.empty()},this),t},destroy:function(){return this.removeRegions(),t.Controller.prototype.destroy.apply(this,arguments)},_store:function(t,e){this._regions[t]=e,this._setLength()},_remove:function(t,e){this.triggerMethod("before:remove:region",t,e),e.empty(),e.stopListening(),delete this._regions[t],this._setLength(),this.triggerMethod("remove:region",t,e)},_setLength:function(){this.length=n.size(this._regions)}});return t.actAsCollection(e.prototype,"_regions"),e}(r),r.TemplateCache=function(t){this.templateId=t},n.extend(r.TemplateCache,{templateCaches:{},get:function(t){var e=this.templateCaches[t];return e||(e=new r.TemplateCache(t),this.templateCaches[t]=e),e.load()},clear:function(){var t,e=s.call(arguments),n=e.length;if(n>0)for(t=0;n>t;t++)delete this.templateCaches[e[t]];else this.templateCaches={}}}),n.extend(r.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(t),this.compiledTemplate},loadTemplate:function(t){var n=e.$(t).html();if(!n||0===n.length)throw new r.Error({name:"NoTemplateError",message:'Could not find template: "'+t+'"'});return n},compileTemplate:function(t){return n.template(t)}}),r.Renderer={render:function(t,e){if(!t)throw new r.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var n;return(n="function"==typeof t?t:r.TemplateCache.get(t))(e)}},r.View=e.View.extend({constructor:function(t){n.bindAll(this,"render"),this.options=n.extend({},n.result(this,"options"),n.isFunction(t)?t.call(this):t),this._behaviors=r.Behaviors(this),e.View.apply(this,arguments),r.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled)},getTemplate:function(){return this.getOption("template")},serializeModel:function(t){return t.toJSON.apply(t,s.call(arguments,1))},mixinTemplateHelpers:function(t){t=t||{};var e=this.getOption("templateHelpers");return n.isFunction(e)&&(e=e.call(this)),n.extend(t,e)},normalizeUIKeys:function(t){var e=n.result(this,"ui"),i=n.result(this,"_uiBindings");return r.normalizeUIKeys(t,i||e)},normalizeUIValues:function(t){var e=n.result(this,"ui"),i=n.result(this,"_uiBindings");return r.normalizeUIValues(t,i||e)},configureTriggers:function(){if(this.triggers){var t={},e=this.normalizeUIKeys(n.result(this,"triggers"));return n.each(e,function(e,n){t[n]=this._buildViewTrigger(e)},this),t}},delegateEvents:function(t){return this._delegateDOMEvents(t),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(t){t.bindEntityEvents(this.model,t.getOption("modelEvents")),t.bindEntityEvents(this.collection,t.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(t){var i=t||this.events;n.isFunction(i)&&(i=i.call(this)),i=this.normalizeUIKeys(i),n.isUndefined(t)&&(this.events=i);var r={},s=n.result(this,"behaviorEvents")||{},o=this.configureTriggers(),a=n.result(this,"behaviorTriggers")||{};n.extend(r,s,i,o,a),e.View.prototype.delegateEvents.call(this,r)},undelegateEvents:function(){var t=s.call(arguments);return e.View.prototype.undelegateEvents.apply(this,t),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(t){t.unbindEntityEvents(this.model,t.getOption("modelEvents")),t.unbindEntityEvents(this.collection,t.getOption("collectionEvents"))},this),this},onShowCalled:function(){},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new r.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})
},destroy:function(){if(!this.isDestroyed){var t=s.call(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(t)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(t)),this.unbindUIElements(),this.remove(),n.invoke(this._behaviors,"destroy",t),this}},bindUIElements:function(){this._bindUIElements(),n.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var t=n.result(this,"_uiBindings");this.ui={},n.each(n.keys(t),function(e){var n=t[e];this.ui[e]=this.$(n)},this)}},unbindUIElements:function(){this._unbindUIElements(),n.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(n.each(this.ui,function(t,e){delete this.ui[e]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(t){var e=n.isObject(t),i=n.defaults({},e?t:{},{preventDefault:!0,stopPropagation:!0}),r=e?i.event:t;return function(t){t&&(t.preventDefault&&i.preventDefault&&t.preventDefault(),t.stopPropagation&&i.stopPropagation&&t.stopPropagation());var e={view:this,model:this.model,collection:this.collection};this.triggerMethod(r,e)}},setElement:function(){var t=e.View.prototype.setElement.apply(this,arguments);return n.invoke(this._behaviors,"proxyViewProperties",this),t},triggerMethod:function(){var t=arguments,e=r.triggerMethod,i=e.apply(this,t);return n.each(this._behaviors,function(n){e.apply(n,t)}),i},normalizeMethods:r.normalizeMethods,getOption:r.proxyGetOption,bindEntityEvents:r.proxyBindEntityEvents,unbindEntityEvents:r.proxyUnbindEntityEvents}),r.ItemView=r.View.extend({constructor:function(){r.View.apply(this,arguments)},serializeData:function(){var t={};return this.model?t=n.partial(this.serializeModel,this.model).apply(this,arguments):this.collection&&(t={items:n.partial(this.serializeCollection,this.collection).apply(this,arguments)}),t},serializeCollection:function(t){return t.toJSON.apply(t,s.call(arguments,1))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var t=this.getTemplate();if(t!==!1){if(!t)throw new r.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var e=this.serializeData();e=this.mixinTemplateHelpers(e);var n=r.Renderer.render(t,e,this);return this.attachElContent(n),this}},attachElContent:function(t){return this.$el.html(t),this},destroy:function(){return this.isDestroyed?void 0:r.View.prototype.destroy.apply(this,arguments)}}),r.CollectionView=r.View.extend({childViewEventPrefix:"childview",constructor:function(t){var i=t||{};if(this.sort=n.isUndefined(i.sort)?!0:i.sort,i.collection&&!(i.collection instanceof e.Collection))throw new r.Error("The Collection option passed to this view needs to be an instance of a Backbone.Collection");this.once("render",this._initialEvents),this._initChildViewStorage(),r.View.apply(this,arguments),this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment(),this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this._triggerBeforeShowBufferedChildren(),this.attachBuffer(this,this.elBuffer),this._triggerShowBufferedChildren(),this.initRenderBuffer()},_triggerBeforeShowBufferedChildren:function(){this._isShown&&n.each(this._bufferedChildren,n.partial(this._triggerMethodOnChild,"before:show"))},_triggerShowBufferedChildren:function(){this._isShown&&(n.each(this._bufferedChildren,n.partial(this._triggerMethodOnChild,"show")),this._bufferedChildren=[])},_triggerMethodOnChild:function(t,e){r.triggerMethodOn(e,t)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(t){this.destroyEmptyView();var e=this.getChildView(t),n=this.collection.indexOf(t);this.addChild(t,e,n)},_onCollectionRemove:function(t){var e=this.children.findByModel(t);this.removeChildView(e),this.checkEmpty()},onShowCalled:function(){this.children.each(n.partial(this._triggerMethodOnChild,"show"))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.triggerMethod("render",this),this},resortView:function(){this.render()},_sortViews:function(){var t=this.collection.find(function(t,e){var n=this.children.findByModel(t);return!n||n._index!==e},this);t&&this.resortView()},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren(),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this))},showCollection:function(){var t;this.collection.each(function(e,n){t=this.getChildView(e),this.addChild(e,t,n)},this)},showEmptyView:function(){var t=this.getEmptyView();if(t&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var n=new e.Model;this.addEmptyView(n,t),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(t,e){var i=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");n.isFunction(i)&&(i=i.call(this));var s=this.buildChildView(t,e,i);this.proxyChildEvents(s),this._isShown&&r.triggerMethodOn(s,"before:show"),this.children.add(s),this.renderChildView(s,-1),this._isShown&&r.triggerMethodOn(s,"show")},getChildView:function(){var t=this.getOption("childView");if(!t)throw new r.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return t},addChild:function(t,e,i){var r=this.getOption("childViewOptions");n.isFunction(r)&&(r=r.call(this,t,i));var s=this.buildChildView(t,e,r);return this._updateIndices(s,!0,i),this._addChildView(s,i),s},_updateIndices:function(t,e,n){this.sort&&(e?(t._index=n,this.children.each(function(e){e._index>=t._index&&e._index++})):this.children.each(function(e){e._index>=t._index&&e._index--}))},_addChildView:function(t,e){this.proxyChildEvents(t),this.triggerMethod("before:add:child",t),this.children.add(t),this.renderChildView(t,e),this._isShown&&!this.isBuffering&&r.triggerMethodOn(t,"show"),this.triggerMethod("add:child",t)},renderChildView:function(t,e){return t.render(),this.attachHtml(this,t,e),t},buildChildView:function(t,e,i){var r=n.extend({model:t},i);return new e(r)},removeChildView:function(t){return t&&(this.triggerMethod("before:remove:child",t),t.destroy?t.destroy():t.remove&&t.remove(),this.stopListening(t),this.children.remove(t),this.triggerMethod("remove:child",t),this._updateIndices(t,!1)),t},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(t,e){t.$el.append(e)},attachHtml:function(t,e,n){t.isBuffering?(t.elBuffer.appendChild(e.el),t._bufferedChildren.push(e)):t._insertBefore(e,n)||t._insertAfter(e)},_insertBefore:function(t,e){var n,i=this.sort&&e<this.children.length-1;return i&&(n=this.children.find(function(t){return t._index===e+1})),n?(n.$el.before(t.el),!0):!1},_insertAfter:function(t){this.$el.append(t.el)},_initChildViewStorage:function(){this.children=new e.ChildViewContainer},destroy:function(){return this.isDestroyed?void 0:(this.triggerMethod("before:destroy:collection"),this.destroyChildren(),this.triggerMethod("destroy:collection"),r.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(){var t=this.children.map(n.identity);return this.children.each(this.removeChildView,this),this.checkEmpty(),t},proxyChildEvents:function(t){var e=this.getOption("childViewEventPrefix");this.listenTo(t,"all",function(){var i=s.call(arguments),r=i[0],o=this.normalizeMethods(n.result(this,"childEvents"));i[0]=e+":"+r,i.splice(1,0,t),"undefined"!=typeof o&&n.isFunction(o[r])&&o[r].apply(this,i.slice(1)),this.triggerMethod.apply(this,i)},this)}}),r.CompositeView=r.CollectionView.extend({constructor:function(){r.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(){var t=this.getOption("childView")||this.constructor;if(!t)throw new r.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return t},serializeData:function(){var t={};return this.model&&(t=n.partial(this.serializeModel,this.model).apply(this,arguments)),t},render:function(){return this._ensureViewIsIntact(),this.isRendered=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this.triggerMethod("render",this),this},_renderChildren:function(){this.isRendered&&r.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var t={};t=this.serializeData(),t=this.mixinTemplateHelpers(t),this.triggerMethod("before:render:template");var e=this.getTemplate(),n=r.Renderer.render(e,t,this);this.attachElContent(n),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(t){return this.$el.html(t),this},attachBuffer:function(t,e){var n=this.getChildViewContainer(t);n.append(e)},_insertAfter:function(t){var e=this.getChildViewContainer(this);e.append(t.el)},getChildViewContainer:function(t){if("$childViewContainer"in t)return t.$childViewContainer;var e,i=r.getOption(t,"childViewContainer");if(i){var s=n.isFunction(i)?i.call(t):i;if(e="@"===s.charAt(0)&&t.ui?t.ui[s.substr(4)]:t.$(s),e.length<=0)throw new r.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+t.childViewContainer})}else e=t.$el;return t.$childViewContainer=e,e},resetChildViewContainer:function(){this.$childViewContainer&&delete this.$childViewContainer}}),r.LayoutView=r.ItemView.extend({regionClass:r.Region,constructor:function(t){t=t||{},this._firstRender=!0,this._initializeRegions(t),r.ItemView.call(this,t)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),r.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.regionManager.destroy(),r.ItemView.prototype.destroy.apply(this,arguments))},addRegion:function(t,e){this.triggerMethod("before:region:add",t);var n={};return n[t]=e,this._buildRegions(n)[t]},addRegions:function(t){return this.regions=n.extend({},this.regions,t),this._buildRegions(t)},removeRegion:function(t){return this.triggerMethod("before:region:remove",t),delete this.regions[t],this.regionManager.removeRegion(t)},getRegion:function(t){return this.regionManager.get(t)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(t){var e=this,n={regionClass:this.getOption("regionClass"),parentEl:function(){return e.$el}};return this.regionManager.addRegions(t,n)},_initializeRegions:function(t){var e;this._initRegionManager(),e=n.isFunction(this.regions)?this.regions(t):this.regions||{};var i=this.getOption.call(t,"regions");n.isFunction(i)&&(i=i.call(this,t)),n.extend(e,i),e=this.normalizeUIValues(e),this.addRegions(e)},_reInitializeRegions:function(){this.regionManager.emptyRegions(),this.regionManager.each(function(t){t.reset()})},getRegionManager:function(){return new r.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.listenTo(this.regionManager,"before:add:region",function(t){this.triggerMethod("before:add:region",t)}),this.listenTo(this.regionManager,"add:region",function(t,e){this[t]=e,this.triggerMethod("add:region",t,e)}),this.listenTo(this.regionManager,"before:remove:region",function(t){this.triggerMethod("before:remove:region",t)}),this.listenTo(this.regionManager,"remove:region",function(t,e){delete this[t],this.triggerMethod("remove:region",t,e)})}}),r.Behavior=function(t,e){function n(e,n){this.view=n,this.defaults=t.result(this,"defaults")||{},this.options=t.extend({},this.defaults,e),this.$=function(){return this.view.$.apply(this.view,arguments)},this.initialize.apply(this,arguments)}return t.extend(n.prototype,e.Events,{initialize:function(){},destroy:function(){this.stopListening()},proxyViewProperties:function(t){this.$el=t.$el,this.el=t.el},triggerMethod:r.triggerMethod,getOption:r.proxyGetOption,bindEntityEvents:r.proxyBindEntityEvents,unbindEntityEvents:r.proxyUnbindEntityEvents}),n.extend=r.extend,n}(n,e),r.Behaviors=function(t,e){function n(t,i){return e.isObject(t.behaviors)?(i=n.parseBehaviors(t,i||e.result(t,"behaviors")),n.wrap(t,i,e.keys(r)),i):{}}function i(t,n){this._view=t,this._viewUI=e.result(t,"ui"),this._behaviors=n,this._triggers={}}var r={behaviorTriggers:function(t,e){var n=new i(this,e);return n.buildBehaviorTriggers()},behaviorEvents:function(n,i){var r={},s=e.result(this,"ui");return e.each(i,function(n,i){var o={},a=e.clone(e.result(n,"events"))||{},u=e.result(n,"ui"),h=e.extend({},s,u);a=t.normalizeUIKeys(a,h),e.each(e.keys(a),function(t){var r=new Array(i+2).join(" "),s=t+r,u=e.isFunction(a[t])?a[t]:n[a[t]];o[s]=e.bind(u,n)}),r=e.extend(r,o)}),r}};return e.extend(n,{behaviorsLookup:function(){throw new t.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(t,i){return t.behaviorClass?t.behaviorClass:e.isFunction(n.behaviorsLookup)?n.behaviorsLookup.apply(this,arguments)[i]:n.behaviorsLookup[i]},parseBehaviors:function(t,i){return e.chain(i).map(function(i,r){var s=n.getBehaviorClass(i,r),o=new s(i,t),a=n.parseBehaviors(t,e.result(o,"behaviors"));return[o].concat(a)}).flatten().value()},wrap:function(t,n,i){e.each(i,function(i){t[i]=e.partial(r[i],t[i],n)})}}),e.extend(i.prototype,{buildBehaviorTriggers:function(){return e.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(n,i){var r=e.extend({},this._viewUI,e.result(n,"ui")),s=e.clone(e.result(n,"triggers"))||{};s=t.normalizeUIKeys(s,r),e.each(s,e.partial(this._setHandlerForBehavior,n,i),this)},_setHandlerForBehavior:function(t,e,n,i){var r=i.replace(/^\S+/,function(t){return t+".behaviortriggers"+e});this._triggers[r]=this._view._buildViewTrigger(n)}}),n}(r,n),r.AppRouter=e.Router.extend({constructor:function(t){e.Router.apply(this,arguments),this.options=t||{};var n=this.getOption("appRoutes"),i=this._getController();this.processAppRoutes(i,n),this.on("route",this._processOnRoute,this)},appRoute:function(t,e){var n=this._getController();this._addAppRoute(n,t,e)},_processOnRoute:function(t,e){var i=n.invert(this.getOption("appRoutes"))[t];n.isFunction(this.onRoute)&&this.onRoute(t,i,e)},processAppRoutes:function(t,e){if(e){var i=n.keys(e).reverse();n.each(i,function(n){this._addAppRoute(t,n,e[n])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(t,e,i){var s=t[i];if(!s)throw new r.Error('Method "'+i+'" was not found on the controller');this.route(e,i,n.bind(s,t))},getOption:r.proxyGetOption}),r.Application=function(t){this.options=t,this._initializeRegions(t),this._initCallbacks=new r.Callbacks,this.submodules={},n.extend(this,t),this._initChannel(),this.initialize.apply(this,arguments)},n.extend(r.Application.prototype,e.Events,{initialize:function(){},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(t){this._initCallbacks.add(t)},start:function(t){this.triggerMethod("before:start",t),this._initCallbacks.run(t,this),this.triggerMethod("start",t)},addRegions:function(t){return this._regionManager.addRegions(t)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(t){return this._regionManager.removeRegion(t)},getRegion:function(t){return this._regionManager.get(t)},getRegions:function(){return this._regionManager.getRegions()},module:function(t,e){var n=r.Module.getClass(e),i=s.call(arguments);return i.unshift(this),n.create.apply(n,i)},getRegionManager:function(){return new r.RegionManager},_initializeRegions:function(t){var e=n.isFunction(this.regions)?this.regions(t):this.regions||{};this._initRegionManager();var i=r.getOption(t,"regions");return n.isFunction(i)&&(i=i.call(this,t)),n.extend(e,i),this.addRegions(e),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this.listenTo(this._regionManager,"before:add:region",function(t){this.triggerMethod("before:add:region",t)}),this.listenTo(this._regionManager,"add:region",function(t,e){this[t]=e,this.triggerMethod("add:region",t,e)}),this.listenTo(this._regionManager,"before:remove:region",function(t){this.triggerMethod("before:remove:region",t)}),this.listenTo(this._regionManager,"remove:region",function(t,e){delete this[t],this.triggerMethod("remove:region",t,e)})},_initChannel:function(){this.channelName=n.result(this,"channelName")||"global",this.channel=n.result(this,"channel")||e.Wreqr.radio.channel(this.channelName),this.vent=n.result(this,"vent")||this.channel.vent,this.commands=n.result(this,"commands")||this.channel.commands,this.reqres=n.result(this,"reqres")||this.channel.reqres},triggerMethod:r.triggerMethod,getOption:r.proxyGetOption}),r.Application.extend=r.extend,r.Module=function(t,e,i){this.moduleName=t,this.options=n.extend({},this.options,i),this.initialize=i.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=e,n.isFunction(this.initialize)&&this.initialize(t,e,this.options)},r.Module.extend=r.extend,n.extend(r.Module.prototype,e.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(t){this._initializerCallbacks.add(t)},addFinalizer:function(t){this._finalizerCallbacks.add(t)},start:function(t){this._isInitialized||(n.each(this.submodules,function(e){e.startWithParent&&e.start(t)}),this.triggerMethod("before:start",t),this._initializerCallbacks.run(t,this),this._isInitialized=!0,this.triggerMethod("start",t))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),n.each(this.submodules,function(t){t.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(t,e){this._runModuleDefinition(t,e)},_runModuleDefinition:function(t,i){if(t){var s=n.flatten([this,this.app,e,r,e.$,n,i]);t.apply(this,s)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new r.Callbacks,this._finalizerCallbacks=new r.Callbacks},triggerMethod:r.triggerMethod}),n.extend(r.Module,{create:function(t,e,i){var r=t,o=s.call(arguments);o.splice(0,3),e=e.split(".");var a=e.length,u=[];return u[a-1]=i,n.each(e,function(e,n){var s=r;r=this._getModule(s,e,t,i),this._addModuleDefinition(s,r,u[n],o)},this),r},_getModule:function(t,e,i,r){var s=n.extend({},r),o=this.getClass(r),a=t[e];return a||(a=new o(e,i,s),t[e]=a,t.submodules[e]=a),a},getClass:function(t){var e=r.Module;return t?t.prototype instanceof e?t:t.moduleClass||e:e},_addModuleDefinition:function(t,e,n,i){var r=this._getDefine(n),s=this._getStartWithParent(n,e);r&&e.addDefinition(r,i),this._addStartWithParent(t,e,s)},_getStartWithParent:function(t,e){var i;return n.isFunction(t)&&t.prototype instanceof r.Module?(i=e.constructor.prototype.startWithParent,n.isUndefined(i)?!0:i):n.isObject(t)?(i=t.startWithParent,n.isUndefined(i)?!0:i):!0},_getDefine:function(t){return!n.isFunction(t)||t.prototype instanceof r.Module?n.isObject(t)?t.define:null:t},_addStartWithParent:function(t,e,n){e.startWithParent=e.startWithParent&&n,e.startWithParent&&!e.startWithParentIsConfigured&&(e.startWithParentIsConfigured=!0,t.addInitializer(function(t){e.startWithParent&&e.start(t)}))}}),r}),Backbone.Marionette.CollectionView.prototype.addChildView=function(t){var e=this.options.filter||this.filter;if(!e||e.call(this,t)){this.closeEmptyView();var n=this.getItemView(t),i=this.collection.indexOf(t);this.addItemView(t,n,i)}},Backbone.Marionette.CollectionView.prototype.showCollection=function(){var t=this.options.filter||this.filter;this.collection.each(function(e,n){if(!t||t.call(this,e)){var i=this.getItemView(e);this.addItemView(e,i,n)}},this)},function(t,e){if("function"==typeof define&&define.amd)define(["exports","jquery"],function(t,n){return e(t,n)});else if("undefined"!=typeof exports){var n=require("jquery");e(exports,n)}else e(t,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e){function n(t,n){function r(t,e,n){return t[e]=n,t}function s(t,e){for(var n,s=t.match(i.key);void 0!==(n=s.pop());)if(i.push.test(n)){var a=o(t.replace(/\[\]$/,""));e=r([],a,e)}else i.fixed.test(n)?e=r([],n,e):i.named.test(n)&&(e=r({},n,e));return e}function o(t){return void 0===f[t]&&(f[t]=0),f[t]++}function a(t){switch(e('[name="'+t.name+'"]',n).attr("type")){case"checkbox":return"on"===t.value?!0:t.value;default:return t.value}}function u(e){if(!i.validate.test(e.name))return this;var n=s(e.name,a(e));return d=t.extend(!0,d,n),this}function h(e){if(!t.isArray(e))throw new Error("formSerializer.addPairs expects an Array");for(var n=0,i=e.length;i>n;n++)this.addPair(e[n]);return this}function l(){return d}function c(){return JSON.stringify(l())}var d={},f={};this.addPair=u,this.addPairs=h,this.serialize=l,this.serializeJSON=c}var i={validate:/^[a-z_][a-z0-9_]*(?:\[(?:\d*|[a-z0-9_]+)\])*$/i,key:/[a-z0-9_]+|(?=\[\])/gi,push:/^$/,fixed:/^\d+$/,named:/^[a-z0-9_]+$/i};return n.patterns=i,n.serializeObject=function(){return this.length>1?new Error("jquery-serialize-object can only serialize one form at a time"):new n(e,this).addPairs(this.serializeArray()).serialize()},n.serializeJSON=function(){return this.length>1?new Error("jquery-serialize-object can only serialize one form at a time"):new n(e,this).addPairs(this.serializeArray()).serializeJSON()},"undefined"!=typeof e.fn&&(e.fn.serializeObject=n.serializeObject,e.fn.serializeJSON=n.serializeJSON),t.FormSerializer=n,n}),console.log("test");